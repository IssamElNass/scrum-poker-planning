name: poker-planning
# See https://www.digitalocean.com/docs/app-platform/#regional-availability for the available options
# You can get region slugs from https://www.digitalocean.com/docs/platform/availability-matrix/
# `fra` stands for Frankfurt (Germany - EU)
region: fra
alerts:
  - rule: DEPLOYMENT_FAILED
  - rule: DOMAIN_FAILED
services:
  - name: poker-planning-app
    # Use Docker build from root directory
    dockerfile_path: Dockerfile
    source_dir: /
    github:
      branch: main
      deploy_on_push: true
      repo: INQTR/poker-planning
    # Health check for Next.js app
    health_check:
      http_path: /api/health
    # Next.js default port
    http_port: 3000
    # For production workloads, increase instance count
    instance_count: 1
    # Start with basic size, can be upgraded based on usage
    instance_size_slug: basic-xxs
    # Route all traffic to the Next.js app
    routes:
      - path: /
    envs:
      # Convex configuration - set these in DigitalOcean dashboard
      - key: NEXT_PUBLIC_CONVEX_URL
        scope: RUN_TIME
        type: SECRET
      - key: NODE_ENV
        scope: RUN_TIME
        value: production
      - key: NEXT_TELEMETRY_DISABLED
        scope: RUN_TIME
        value: "1"
      # Custom domain environment variables (update with your domain)
      - key: NEXTAUTH_URL
        scope: RUN_TIME
        value: https://yourdomain.com
      - key: NEXT_PUBLIC_APP_URL
        scope: RUN_TIME
        value: https://yourdomain.com
# Custom domains configuration (uncomment and update with your domain from mijnhost.be)
# domains:
#   - name: yourdomain.com
#     type: PRIMARY
#   - name: www.yourdomain.com
#     type: ALIAS
